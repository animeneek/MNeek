<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Same head as index.html -->
    <style>
        .player-container {
            aspect-ratio: 16/9;
        }
    </style>
</head>
<body class="bg-black text-white">
    <!-- Simple back button -->
    <nav class="absolute top-4 left-4 z-50">
        <a href="#" onclick="window.history.back()" class="bg-black/50 hover:bg-black/70 p-2 rounded-full">
            <i class="fas fa-arrow-left text-xl"></i>
        </a>
    </nav>
    
    <main>
        <!-- Player -->
        <div class="player-container w-full max-w-6xl mx-auto">
            <iframe id="player" src="" frameborder="0" allowfullscreen class="w-full h-full"></iframe>
        </div>
        
        <!-- Info -->
        <div class="px-4 md:px-10 py-6">
            <h1 id="watchTitle" class="text-2xl font-bold mb-2"></h1>
            <div class="flex items-center space-x-4 mb-4">
                <span id="watchYear" class="text-gray-400"></span>
                <span id="watchRating" class="text-yellow-400"></span>
            </div>
            <p id="watchOverview" class="text-gray-300"></p>
        </div>
    </main>

    <script>
        // Get URL parameters
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        const type = urlParams.get('type');
        const season = urlParams.get('s');
        const episode = urlParams.get('e');
        
        // Set player source
        function setupPlayer() {
            const player = document.getElementById('player');
            let embedUrl;
            
            if (type === 'movie') {
                embedUrl = `https://player.embed-api.stream/?id=${id}&type=movie`;
            } else {
                embedUrl = `https://player.embed-api.stream/?id=${id}&s=${season || 1}&e=${episode || 1}`;
            }
            
            player.src = embedUrl;
        }
        
        // Fetch item details for the info section
        async function fetchWatchDetails() {
            try {
                const url = type === 'movie' 
                    ? `https://api.themoviedb.org/3/movie/${id}?api_key=e3afd4c89e3351edad9e875ff7a01f0c`
                    : `https://api.themoviedb.org/3/tv/${id}?api_key=e3afd4c89e3351edad9e875ff7a01f0c`;
                
                const response = await fetch(url);
                const data = await response.json();
                
                document.getElementById('watchTitle').textContent = type === 'movie' ? data.title : data.name;
                document.getElementById('watchYear').textContent = (type === 'movie' ? data.release_date : data.first_air_date)?.substring(0, 4) || '';
                document.getElementById('watchRating').textContent = `${data.vote_average?.toFixed(1) || 'N/A'}/10`;
                document.getElementById('watchOverview').textContent = data.overview || 'No overview available.';
            } catch (error) {
                console.error('Error fetching watch details:', error);
            }
        }
        
        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            setupPlayer();
            fetchWatchDetails();
        });
    </script>
</body>
</html>
